<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel de Admin</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: auto; padding: 20px; }
        .container { background-color: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        h2 { border-bottom: 2px solid #eee; padding-bottom: 10px; }
        input, select, button { padding: 8px; font-size: 16px; margin-right: 10px; }
        button { cursor: pointer; color: white; border: none; border-radius: 5px; }
        .add-player-btn { background-color: #28a745; }
        .add-item-btn { background-color: #007bff; }
    </style>
</head>
<body>
    <h1>Painel de Administração</h1>

    <div class="container">
        <h2>Adicionar Novo Jogador</h2>
        <form id="form-add-jogador">
            <input type="text" id="nome-jogador" placeholder="Nome do Jogador" required>
            <button type="submit" class="add-player-btn">Adicionar Jogador</button>
        </form>
    </div>

    <div class="container">
        <h2>Adicionar Item ao Inventário</h2>
        <form id="form-add-item">
            <select id="select-jogador" required></select>
            <select id="select-item" required></select>
            <button type="submit" class="add-item-btn">Adicionar Item</button>
        </form>
    </div>

    <script>
        // --- LÓGICA PARA ADICIONAR JOGADOR (já existente) ---
        document.getElementById('form-add-jogador').addEventListener('submit', function(event) {
            event.preventDefault();
            const nomeInput = document.getElementById('nome-jogador');
            fetch('/api/jogador', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ nome: nomeInput.value }),
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message || data.error);
                nomeInput.value = '';
                carregarJogadores(); // Atualiza a lista de jogadores no outro formulário
            });
        });

        // --- LÓGICA PARA O NOVO FORMULÁRIO DE ITENS ---
        const selectJogador = document.getElementById('select-jogador');
        const selectItem = document.getElementById('select-item');

        // Função para carregar jogadores no dropdown
        function carregarJogadores() {
            fetch('/api/jogadores')
                .then(res => res.json())
                .then(jogadores => {
                    selectJogador.innerHTML = '<option value="">Selecione um Jogador</option>';
                    jogadores.forEach(j => {
                        selectJogador.innerHTML += `<option value="${j.id}">${j.nome}</option>`;
                    });
                });
        }

        // Função para carregar itens no dropdown
        function carregarItens() {
            fetch('/api/itens')
                .then(res => res.json())
                .then(itens => {
                    selectItem.innerHTML = '<option value="">Selecione um Item</option>';
                    itens.forEach(i => {
                        selectItem.innerHTML += `<option value="${i.id}">${i.nome}</option>`;
                    });
                });
        }
        
        // Carrega os dados assim que a página abre
        document.addEventListener('DOMContentLoaded', function() {
            carregarJogadores();
            carregarItens();
        });

        // Event listener para o envio do formulário de adicionar item
        document.getElementById('form-add-item').addEventListener('submit', function(event) {
            event.preventDefault();
            const jogadorId = selectJogador.value;
            const itemId = selectItem.value;

            fetch('/api/inventario/adicionar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ jogador_id: jogadorId, item_id: itemId }),
            })
            .then(res => res.json())
            .then(data => {
                alert(data.message || data.error);
            });
        });
    </script>
</body>
</html>